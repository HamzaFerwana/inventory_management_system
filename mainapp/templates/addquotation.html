{% extends 'base.html' %}
{% load static %}

{% block title %}{% if quotation %}Edit Quotation{% else %}Add Quotation{% endif %}{% endblock %}

{% block content %}
<div class="page-header">
	<div class="page-title">
		<h4>Quotation</h4>
		<h6>{% if quotation %}Update Quotation{% else %}Create Quotation{% endif %}</h6>
	</div>
</div>

{% if errors %}
<div class="alert alert-danger" role="alert">
	<ul class="mb-0">
		{% for error in errors %}
		<li>{{ error }}</li>
		{% endfor %}
	</ul>
</div>
{% endif %}

<div class="card">
	<div class="card-body">
		<form method="POST">
			{% csrf_token %}
			<div class="row">
				<div class="col-lg-4 col-sm-6 col-12">
					<div class="form-group">
						<label>Reference <span style="color: red">*</span></label>
						<input
							type="text"
							name="reference"
							value="{{ old.reference }}"
							placeholder="Enter reference number"
							required
						/>
					</div>
				</div>

				<div class="col-lg-4 col-sm-6 col-12">
					<div class="form-group">
						<label>Customer <span style="color: red">*</span></label>
						<select class="select" name="customer_id" required>
							<option value="">Select customer</option>
							{% for customer in customers %}
							<option
								value="{{ customer.id }}"
								{% if old.customer_id|stringformat:'s' == customer.id|stringformat:'s' %}selected{% endif %}
							>
								{{ customer.name }}
							</option>
							{% endfor %}
						</select>
					</div>
				</div>

				<div class="col-lg-4 col-sm-6 col-12">
					<div class="form-group">
						<label>Product <span style="color: red">*</span></label>
						<select class="select" name="product_id" required>
							<option value="">Select product</option>
							{% for product in products %}
							<option
								value="{{ product.id }}"
								{% if old.product_id|stringformat:'s' == product.id|stringformat:'s' %}selected{% endif %}
							>
								{{ product.name }} ({{ product.sku }})
							</option>
							{% endfor %}
						</select>
					</div>
				</div>

				<div class="col-lg-3 col-sm-6 col-12">
					<div class="form-group">
						<label>Quantity <span style="color: red">*</span></label>
						<input
							type="number"
							name="quantity"
							value="{{ old.quantity|default:'1' }}"
							min="1"
							required
						/>
					</div>
				</div>

				<div class="col-lg-3 col-sm-6 col-12">
					<div class="form-group">
						<label>Unit Price <span style="color: red">*</span></label>
						<input
							type="number"
							step="0.01"
							name="unit_price"
							value="{{ old.unit_price|default:'0' }}"
							required
						/>
					</div>
				</div>

				<div class="col-lg-3 col-sm-6 col-12">
					<div class="form-group">
						<label>Discount (%)</label>
						<input
							type="number"
							step="0.01"
							name="discount_percentage"
							value="{{ old.discount_percentage|default:'0' }}"
							min="0"
						/>
					</div>
				</div>

				<div class="col-lg-3 col-sm-6 col-12">
					<div class="form-group">
						<label>Tax (%)</label>
						<input
							type="number"
							step="0.01"
							name="tax_percentage"
							value="{{ old.tax_percentage|default:'0' }}"
							min="0"
						/>
					</div>
				</div>

				<div class="col-lg-4 col-sm-6 col-12">
					<div class="form-group">
						<label>Status</label>
						<select class="select" name="status">
							{% for value, label in status_choices %}
							<option
								value="{{ value }}"
								{% if old.status == value %}selected{% endif %}
							>
								{{ label }}
							</option>
							{% endfor %}
						</select>
					</div>
				</div>

				<div class="col-lg-8 col-sm-12 col-12">
					<div class="form-group">
						<label>Notes</label>
						<textarea
							class="form-control"
							name="notes"
							placeholder="Optional notes"
							rows="3"
						>{{ old.notes }}</textarea>
					</div>
				</div>

				<div class="col-lg-12">
					<button type="submit" class="btn btn-submit me-2">Submit</button>
					<a href="{% url 'quotations_index' %}" class="btn btn-cancel">Cancel</a>
				</div>
			</div>
		</form>
	</div>
</div>

{% endblock %}